<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.13.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="针对渲染过程的简单的信号处理基础姿势~">
<meta property="og:type" content="article">
<meta property="og:title" content="渲染基础理论-采样&amp;重建">
<meta property="og:url" content="http://example.com/2022/07/18/CG-Theory-Sampling&Reconstruct/index.html">
<meta property="og:site_name" content="&quot;The World&quot; of CLV">
<meta property="og:description" content="针对渲染过程的简单的信号处理基础姿势~">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-07-18T08:58:10.000Z">
<meta property="article:modified_time" content="2022-11-11T08:02:25.125Z">
<meta property="article:author" content="CLV">
<meta property="article:tag" content="Rendering">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2022/07/18/CG-Theory-Sampling&Reconstruct/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2022/07/18/CG-Theory-Sampling&Reconstruct/","path":"2022/07/18/CG-Theory-Sampling&Reconstruct/","title":"渲染基础理论-采样&重建"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>渲染基础理论-采样&重建 | "The World" of CLV</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">"The World" of CLV</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-guestbook"><a href="/guestbook/" rel="section"><i class="comment fa-fw"></i>guestbook</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="user fa-fw"></i>About</a></li><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%AC%E6%96%87%E8%BD%AC%E8%87%AA%E6%88%91%E5%8E%9F%E6%9D%A5%E7%9A%84%E6%B4%9B%E8%B0%B7%E5%8D%9A%E5%AE%A2"><span class="nav-number">1.</span> <span class="nav-text">本文转自我原来的洛谷博客</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#text-1-%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2"><span class="nav-number"></span> <span class="nav-text">$\text{1.傅里叶变换}$</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#text-1-1-Recap"><span class="nav-number"></span> <span class="nav-text">$\text{1.1.Recap}$</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#text-1-2-%E5%B8%B8%E8%A7%81%E4%BF%A1%E5%8F%B7%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2"><span class="nav-number"></span> <span class="nav-text">$\text{1.2.常见信号的傅里叶变换}$</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#text-1-2-1-%E7%9B%92%E5%AD%90%E5%87%BD%E6%95%B0"><span class="nav-number">1.</span> <span class="nav-text">$\text{1.2.1.盒子函数}$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#text-1-2-2-%E9%AB%98%E6%96%AF%E5%87%BD%E6%95%B0"><span class="nav-number">2.</span> <span class="nav-text">$\text{1.2.2.高斯函数}$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#text-1-2-3-%E5%B8%B8%E5%80%BC%E5%87%BD%E6%95%B0"><span class="nav-number">3.</span> <span class="nav-text">$\text{1.2.3.常值函数}$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#text-1-2-4-%E4%BD%99%E5%BC%A6%EF%BC%88%E6%AD%A3%E5%BC%A6%EF%BC%89%E6%B3%A2"><span class="nav-number">4.</span> <span class="nav-text">$\text{1.2.4.余弦（正弦）波}$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#text-1-2-5-Shah%E5%87%BD%E6%95%B0"><span class="nav-number">5.</span> <span class="nav-text">$\text{1.2.5.Shah函数}$</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#text-2-%E7%90%86%E6%83%B3%E7%9A%84%E9%87%87%E6%A0%B7%E4%B8%8E%E9%87%8D%E5%BB%BA"><span class="nav-number"></span> <span class="nav-text">$\text{2.理想的采样与重建}$</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#text-3-%E8%B5%B0%E6%A0%B7"><span class="nav-number"></span> <span class="nav-text">$\text{3.走样}$</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#text-3-1-Recap-GAMES101"><span class="nav-number"></span> <span class="nav-text">$\text{3.1.Recap:GAMES101}$</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#text-3-2-%E5%8F%8D%E8%B5%B0%E6%A0%B7"><span class="nav-number"></span> <span class="nav-text">$\text{3.2.反走样}$</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#text-3-2-1-%E9%9D%9E%E4%B8%80%E8%87%B4%E9%87%87%E6%A0%B7"><span class="nav-number">1.</span> <span class="nav-text">$\text{3.2.1.非一致采样}$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#text-3-2-2-%E9%80%82%E5%BA%94%E6%80%A7%E9%87%87%E6%A0%B7"><span class="nav-number">2.</span> <span class="nav-text">$\text{3.2.2.适应性采样}$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#text-3-2-3-%E9%A2%84%E8%BF%87%E6%BB%A4"><span class="nav-number">3.</span> <span class="nav-text">$\text{3.2.3.预过滤}$</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#text-4-%E5%BA%94%E7%94%A8%E8%87%B3%E5%9B%BE%E5%83%8F%E5%90%88%E6%88%90"><span class="nav-number"></span> <span class="nav-text">$\text{4.应用至图像合成}$</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#text-5-%E6%B8%B2%E6%9F%93%E4%B8%AD%E8%B5%B0%E6%A0%B7%E7%9A%84%E6%9D%A5%E6%BA%90"><span class="nav-number"></span> <span class="nav-text">$\text{5.渲染中走样的来源}$</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#text-6-%E5%83%8F%E7%B4%A0%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-number"></span> <span class="nav-text">$\text{6.像素到底是什么}$</span></a></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CLV</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">38</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">15</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/CreeperLordVader-Iclucia-Ashina" class="github-corner" title="Fork me on GitHub!" aria-label="Fork me on GitHub!" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/07/18/CG-Theory-Sampling&Reconstruct/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CLV">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content=""The World" of CLV">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="渲染基础理论-采样&重建 | "The World" of CLV">
      <meta itemprop="description" content="针对渲染过程的简单的信号处理基础姿势~">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          渲染基础理论-采样&重建
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-07-18 16:58:10" itemprop="dateCreated datePublished" datetime="2022-07-18T16:58:10+08:00">2022-07-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-11 16:02:25" itemprop="dateModified" datetime="2022-11-11T16:02:25+08:00">2022-11-11</time>
    </span>

  
</div>

            <div class="post-description">针对渲染过程的简单的信号处理基础姿势~</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="本文转自我原来的洛谷博客"><a href="#本文转自我原来的洛谷博客" class="headerlink" title="本文转自我原来的洛谷博客"></a><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/CreeperLordVader/cai-yang-li-lun"><em>本文转自我原来的洛谷博客</em></a></h3><p>代码懒得写了，闲着没事儿读读PBR学习一下渲染中重要的理论基础，并且记录下来方便自己理解，顺便了解一下数学知识怎么运用~</p>
<span id="more"></span>
<h1 id="text-1-傅里叶变换"><a href="#text-1-傅里叶变换" class="headerlink" title="$\text{1.傅里叶变换}$"></a>$\text{1.傅里叶变换}$</h1><h2 id="text-1-1-Recap"><a href="#text-1-1-Recap" class="headerlink" title="$\text{1.1.Recap}$"></a>$\text{1.1.Recap}$</h2><p>这个数学课上都讲过了，分段光滑周期函数可以进行傅里叶级数展开，但是我印象最深刻的就只剩下这个东西了qwq所以从这里开始对着当时的讲义复习一下吧qwq</p>
<p>对于以$2\pi$为周期的周期函数$f(x)$，有</p>
<p>$$ f(x)&#x3D;\frac{a_0}{2}+\sum\limits_{n&#x3D;1}^{\infty}(a_n\cos nx+b_n\sin nx)\a_n&#x3D;\frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\cos nx dx\b_n&#x3D;\frac{1}{\pi}\int_{-\pi}^{\pi}f(x)\sin nx dx$$</p>
<p>实际上还可以写成复数形式，但是这里我们就不考虑了。</p>
<p>这里的$\frac{1}{\pi}$不能掉了，因为标准正交函数系是$\sqrt{\frac{1}{2\pi}}$和$\sqrt{\frac{\sin&#x2F;\cos}{\pi}}$</p>
<p>更一般的，做点简单的变量代换，对于以$T$为周期的周期函数$f(x)$，有</p>
<p>$$f(x)&#x3D;\frac{a_0}{2}+\sum\limits_{n&#x3D;1}^{\infty}(a_n \cos \frac{2n\pi}{T}x+b_n \sin \frac{2n\pi}{T}x)$$</p>
<p>$$a_0&#x3D;\frac{1}{\pi}\int_{-\pi}^{\pi}f(x)dx\text{（看成$n&#x3D;0$的$\cos$项）}$$</p>
<p>$$a_n&#x3D;\frac{2}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(x)\cos \frac{2n\pi}{T}x dx,b_n&#x3D;\frac{2}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(x)\sin \frac{2n\pi}{T}x dx$$</p>
<p>对于任何绝对可积，有限区间上分段光滑函数，都可取区间$[-\frac{T}{2},\frac{T}{2}]$，周期延拓到$\mathbb{R}$做展开（这里$f(x)$严格来说应该取其左右极限的平均值，为了减少码字量偷个懒~）</p>
<p>$a_n\cos\frac{2n\pi x}{T}+b_n\sin\frac{2n\pi x}{T}&#x3D;\frac{2}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)(\cos \frac{2n\pi}{T}t\cos\frac{2n\pi x}{T}+\sin \frac{2n\pi}{T}t\sin\frac{2n\pi x}{T} )dt&#x3D;\frac{2}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)[\cos \frac{2n\pi}{T}(x-t)]dt$</p>
<p>于是$f(x)&#x3D;\frac{a_0}{2}+\sum\limits_{n&#x3D;1}\frac{2}{T}\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)[\cos \frac{2n\pi}{T}(x-t)]dt$</p>
<p><strong>对于不想要严格而又臭又长的证明的同学（比如我）来说，下面是一种不严格的理解</strong>：这个求和式长得很像黎曼和，这实际上就是相当于把$[0,+\infty)$分成长为$\frac{2\pi}{T}$的小区间求和</p>
<p>令$F(\lambda)&#x3D;\int_{-\frac{T}{2}}^{\frac{T}{2}}f(t)[\cos \lambda(x-t)]dt$</p>
<p>可以看出</p>
<p>$$f(x)&#x3D;\frac{1}{T}F(0)+\sum\limits_{n&#x3D;1}\frac{2}{T}F(\frac{2\pi n}{T})$$</p>
<p>$$&#x3D;\frac{1}{T}F(0)+\frac{1}{\pi}\sum\limits_{n&#x3D;1}\frac{2\pi}{T}F(\frac{2\pi n}{T})$$</p>
<p>令$T\rightarrow +\infty$得到</p>
<p>$$f(x)&#x3D;\frac{1}{\pi}\int_{0}^{+\infty}\int_{-\infty}^{+\infty}f(t)\cos\lambda(x-t)dtd\lambda$$</p>
<p>里面的积分关于$\lambda$是偶函数，亦可写作</p>
<p>$$f(x)&#x3D;\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(t)\cos\lambda(x-t)dtd\lambda$$</p>
<p>这就是<strong>傅里叶积分的收敛定理</strong></p>
<p>考虑到$\cos x&#x3D;\frac{e^{-ix}+e^{ix}}{2}$</p>
<p>于是将其写为</p>
<p>$$f(x)&#x3D;\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(t)\frac{e^{-i[\lambda(x-t)]}+e^{i[\lambda(x-t)]}}{2}dtd\lambda$$</p>
<p>$$&#x3D;\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(t)\frac{e^{-i[\lambda(x-t)]}+e^{i[\lambda(x-t)]}}{2}dtd\lambda$$</p>
<p>$$&#x3D;\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(t)\frac{e^{-i[\lambda(x-t)]}}{2}dtd\lambda+\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(t)\frac{e^{i[\lambda(x-t)]}}{2}dtd\lambda$$</p>
<p>再次利用这个反常积分关于$\lambda$为偶函数的重要性质，发现前后两项实际上是相等的，于是得到</p>
<p>$$f(x)&#x3D;\frac{1}{2\pi}\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(t)e^{i[\lambda(x-t)]}dtd\lambda$$</p>
<p>$$&#x3D;\frac{1}{2\pi}\int_{-\infty}^{+\infty}e^{i\lambda x}\int_{-\infty}^{+\infty}f(t)e^{-i\lambda t}dtd\lambda$$</p>
<p>这就是我们熟悉的傅里叶变换式了</p>
<p><strong>显然，上述过程是极不严格的，收敛性和一致性都没有证明</strong>，但是严格的证明我懒得研究了，就把这个重要的式子理解就好~</p>
<p>这里PBR书上有个注释，意思是说，在不同领域使用的傅里叶变换定义式不完全相同。的确如此，我的微积分讲义上给出的傅里叶变换直接用的$\lambda$的含参量积分，而PBR书上的含参量积分与此不完全相同。下面都以PBR为准。</p>
<p>把两个积分拆开，并且令$\lambda&#x3D;2\pi\omega$进行换元，这是为了契合PBR书中的符号（当然，这也是符合物理意义的，$\lambda$是波长，$\omega$是转速），我们有函数$f$的<strong>连续形式的傅里叶变换和傅里叶逆变换</strong></p>
<p>$$F(\omega)&#x3D;\mathscr{F}{f}&#x3D;\int_{-\infty}^{+\infty}f(x)e^{-2\pi i\omega x}dx$$</p>
<p>$$f(x)&#x3D;\mathscr{F}^{-1}{f}&#x3D;\int_{-\infty}^{+\infty}F(\omega)e^{2\pi i\omega x}d\omega$$</p>
<p>出于简便起见，PBR特别强调只考虑偶函数$f(x)$，我们也只考虑偶函数，这样一来，我们又可以对$F(\omega)$进行化简</p>
<p>$$F(\omega)&#x3D;\mathscr{F}{f}&#x3D;\int_{0}^{+\infty}f(x)e^{-2\pi i\omega x}dx+\int_{-\infty}^{0}f(x)e^{-2\pi i\omega x}dx$$</p>
<p>$$&#x3D;\int_{0}^{+\infty}f(x)(e^{-2\pi i\omega x}+e^{2\pi i\omega x})dx&#x3D;\int_{-\infty}^{+\infty}f(x)\cos (2\pi \omega x)dx$$</p>
<p>上面我们利用偶函数的性质把两个$e$的幂之和合并为同一个$e$的幂，这里我们其实也是在利用偶函数的性质反着做回去。</p>
<p>有了这个式子，我们发现很好的一点：表达式中不出现虚数单位$i$。这意味着我们得到了一个实值函数。</p>
<p>此外，我们还发现这个式子很像最开始傅里叶级数中三角函数系数的式子，在那里我们用积分定义了新的点积，并且用这个点积“提取”一个周期函数中某个频率的振幅（其依据是三角函数的正交性）。</p>
<p>那么按照类似的理解，这里的积分式也可以看成是“提取”$\omega$频率的振幅（当然，需要严格的证明），我们就知道了$F(\omega)$这个实值函数的意义。也就是大家熟悉的说法，傅里叶变换将时域变换到频域。</p>
<p>值得一提的是，傅里叶变换算子$\mathscr{F}$满足线性性，这个性质是大家都知道的。</p>
<p>值得二提的是大家都知道的“卷积定理”，后面会有叙述。</p>
<p>这一块的数学实在是太多辣，可以参考一下某篇咕咕日报23333</p>
<h2 id="text-1-2-常见信号的傅里叶变换"><a href="#text-1-2-常见信号的傅里叶变换" class="headerlink" title="$\text{1.2.常见信号的傅里叶变换}$"></a>$\text{1.2.常见信号的傅里叶变换}$</h2><p>PBR书中给了一个小表格，列出了一些常见的信号和它们的傅里叶变换，但是没有给出推导。</p>
<h3 id="text-1-2-1-盒子函数"><a href="#text-1-2-1-盒子函数" class="headerlink" title="$\text{1.2.1.盒子函数}$"></a>$\text{1.2.1.盒子函数}$</h3><p>当且仅当$|x|&lt;\frac{1}{2}$时$f(x)&#x3D;1$，否则$f(x)&#x3D;0$</p>
<p>$$F(\omega)&#x3D;\mathscr{F}{f}&#x3D;\int_{-\infty}^{+\infty}f(x)\cos (2\pi \omega x)dx<br>&#x3D;\int_{-\frac{1}{2}}^{\frac{1}{2}}\cos(2\pi\omega x)dx$$</p>
<p>$$&#x3D;\frac{1}{2\pi\omega}\sin(2\pi\omega x)\Big|_{-\frac{1}{2}}^{\frac{1}{2}}&#x3D;\frac{\sin \omega \pi}{\omega\pi}$$</p>
<p>可能是这个函数太常用了，甚至有个专门的名字$\text{sinc}(\omega)&#x3D;\frac{\sin \omega \pi}{\omega\pi}$。</p>
<p>后面还会见到更一般的形式$\Pi_T$，经过伸缩变换可给出$\mathscr{F}{\Pi_T}&#x3D;\frac{\sin 2T\pi\omega}{2T\pi\omega}$</p>
<h3 id="text-1-2-2-高斯函数"><a href="#text-1-2-2-高斯函数" class="headerlink" title="$\text{1.2.2.高斯函数}$"></a>$\text{1.2.2.高斯函数}$</h3><p>$$f(x)&#x3D;e^{-\pi x^2}$$</p>
<p>$$F(\omega)&#x3D;\mathscr{F}{f}&#x3D;\int_{-\infty}^{+\infty}f(x)\cos (2\pi \omega x)dx<br>&#x3D;\int_{-\infty}^{\infty}e^{-\pi x^2}\cos(2\pi\omega x)dx$$</p>
<p>这个积分还是不难求的，利用含参量积分的求导就可以算。当然，我们要有一致收敛性，连续性以及原积分在某点收敛才能进行下面的运算，但是这里略去，自证不难。</p>
<p>$$F’(\omega)&#x3D;-\int_{-\infty}^{+\infty}2\pi x e^{-\pi x^2}\sin (2\pi \omega x)dx$$</p>
<p>$$&#x3D;\int_{-\infty}^{\infty}\sin(2\pi\omega x)de^{-\pi x^2}$$</p>
<p>$$&#x3D;\sin(2\pi\omega x)e^{-\pi x^2}\Big|<em>{-\infty}^{+\infty}-\int</em>{-\infty}^{+\infty}e^{-\pi x^2}d\sin(2\pi\omega x)$$</p>
<p>$$&#x3D;-\int_{-\infty}^{+\infty}2\pi\omega e^{-\pi x^2}\cos(2\pi\omega x)dx&#x3D;-2\pi\omega F(\omega)$$</p>
<p>不出意外，我们得到了一个想要的微分方程，而且它很好解，不过这里还是列出解的过程，把 $F(\omega)$ 除过去就有</p>
<p>$d\ln |F(\omega)|&#x3D;-2\pi\omega d\omega&#x3D;-\pi d\omega^2$，于是</p>
<p>$F(\omega)&#x3D;Ce^{-\pi \omega^2}$，代入 $\omega&#x3D;0$ 的边界条件（这是经典的高斯积分，$\int_{-\infty}^{\infty}e^{-a x^2}dx&#x3D;\sqrt{\frac{\pi}{a}}$）就能得到 $F(\omega)&#x3D;e^{-\pi \omega^2}$</p>
<p>真棒啊，高斯函数傅里叶变换前后是没有变化的。</p>
<h3 id="text-1-2-3-常值函数"><a href="#text-1-2-3-常值函数" class="headerlink" title="$\text{1.2.3.常值函数}$"></a>$\text{1.2.3.常值函数}$</h3><p>考虑$f(x)&#x3D;1$，我们发现反常积分是发散的，当 $\omega&#x3D;0$ 时反常积分为正无穷大，对此，有一个专门的函数叫做<strong>狄拉克函数</strong>$\delta$，它只在 $0$ 处取值无穷大（虽然在实数域下是发散的，但是它在广义实数域下还是有值吧qwq），其它情况下取值均为 $0$ 。</p>
<p>关于狄拉克函数还可以多说几句，这是个广义函数（广义函数的定义可以参考卓里奇但是我忘记了）。不过这也没什么关系。实际在渲染中，狄拉克函数经常用来表示一些有奇异的东西，比如完美的反射&#x2F;折射的 $\text{BSDF}$。</p>
<p>不过有些教学渲染器为了使代码更加一致选择用粗糙度极小的微表面模型来近似镜面因为狄拉克函数这么不一致的东西会带来很多麻烦。</p>
<p>回到正题上来，于是有 $\mathscr{F}{f(x)&#x3D;1}&#x3D;\delta(\omega)$</p>
<p>上面的说法当然是不严格的，严格的我也不会qwq</p>
<p>网上应该有很多资料，现在只要记住这个特殊函数就好啦。</p>
<p>狄拉克函数有个很重要的特性：$\int f(x)\delta(x)&#x3D;f(0)$</p>
<h3 id="text-1-2-4-余弦（正弦）波"><a href="#text-1-2-4-余弦（正弦）波" class="headerlink" title="$\text{1.2.4.余弦（正弦）波}$"></a>$\text{1.2.4.余弦（正弦）波}$</h3><p>$f(x)&#x3D;\cos x$，用积化和差公式可以容易地算出（其实是我懒得算懒得写啦）</p>
<p>$F(\omega)&#x3D;\mathscr{F}{f}&#x3D;\pi[\delta(1-2\pi\omega)+\delta(1+2\pi\omega)]$</p>
<h3 id="text-1-2-5-Shah函数"><a href="#text-1-2-5-Shah函数" class="headerlink" title="$\text{1.2.5.Shah函数}$"></a>$\text{1.2.5.Shah函数}$</h3><p>也称狄拉克梳状函数，但是PBR上的符号我不知道怎么用Latex写，所以用$\text{III}$模拟一下吧~</p>
<p>$\text{Shah}$ 函数的定义为 $\text{III}<em>T(x)&#x3D;T\sum\limits</em>{i}\delta(x-Ti)$<br>，这可以理解为是在 $\mathbb{R}$ 上以周期 $T$ 等距离采样</p>
<p>其傅里叶变换结果为</p>
<p>$F(\omega)&#x3D;\mathscr{F}{f}&#x3D;\text{III}_{\frac{1}{T}}(\omega)$，真棒啊。</p>
<h1 id="text-2-理想的采样与重建"><a href="#text-2-理想的采样与重建" class="headerlink" title="$\text{2.理想的采样与重建}$"></a>$\text{2.理想的采样与重建}$</h1><p>结束了一节不算很难的数学基础，开始正式进行采样与重建理论的解释了。</p>
<p>前面提过，以周期$T$采样其实就是$\text{III}<em>T(x)&#x3D;T\sum\limits</em>{i}\delta(x-Ti)$，$T$定义了周期，或者说是<strong>采样率</strong>。那么采样的形式化定义其实应该是这样的一个函数：</p>
<p>$$\text{III}<em>T(x)f(x)&#x3D;T\sum\limits</em>{i}\delta(x-Ti)f(iT)$$</p>
<p>看着很唬人，其实意思就是说我们在一个连续函数上等间距取了一列离散的可数点。。。由离散的点得到一个连续的函数称为<strong>重建</strong>，或者说，把这些离散的点“连起来”，显然我们有很多种方式把点连起来。</p>
<p>重建的形式化定义需要使用函数的卷积，类似于数列的卷积，我们可以定义函数的<strong>卷积积分</strong>为</p>
<p>$$f \otimes g&#x3D;\int_{-\infty}^{+\infty}f(t)g(x-t)dt$$</p>
<p>傅里叶变换很好的一个性质就是卷积定理：时域卷积，频域乘积；频域卷积，时域乘积。</p>
<p>$\mathscr{F}{fg}&#x3D;\mathscr{F}{f}\otimes\mathscr{F}{g}$</p>
<p>$\mathscr{F}{f\otimes g}&#x3D;\mathscr{F}{f}\mathscr{F}{g}$</p>
<p>我们可以选取一个<strong>重建滤波函数</strong>$r(x)$，那么重建的过程实际上是得到如下函数：</p>
<p>$$\tilde{f}&#x3D;(\text{III}<em>T(x)f(x))\otimes r(x)<br>&#x3D;T\int</em>{-\infty}^{+\infty}\sum\limits_{i}\delta(t-Ti)f(iT)r(x-t)dt$$</p>
<p>$$&#x3D;T\sum\limits_{i}\int_{-\infty}^{+\infty}\delta(t-Ti)f(iT)r(x-t)dt$$</p>
<p>这里我们又一次不加证明地交换了无穷求和与反常积分。由于狄拉克函数的性质，后面的积分实际上等于$f(iT)r(x-iT)$，于是</p>
<p>$$\tilde{f}(x)&#x3D;T\sum\limits_{i}f(iT)r(x-iT)$$</p>
<p>这东西就变成数列卷积了，下面来探讨其意义。闫令琪曾经在$\text{GAMES101}$里提过，卷积实际上是在频域上将图像复制并且平移，PBR下面就要得到这个结果。为此，PBR首先限制$f$的频率是有穷的，这意味着对$f$做傅里叶变换后得到的$F(\omega)$只在一个有界区间上可能非$0$。</p>
<p>在上面的推导中其实隐含了一个重要的结果：一个函数与狄拉克函数进行卷积得到的函数是该函数本身，而如果我们对狄拉克函数进行平移再卷积，那么得到的函数也进行同样的平移，即</p>
<p>$$f(x)\otimes \delta(x-a)&#x3D;\int_{-\infty}^{+\infty}\delta(t-a)f(x-t)dt&#x3D;f(x-a)$$</p>
<p>我们将$\tilde{f}$变换至频域，即有</p>
<p>$$\mathscr{F}{\tilde{f}}&#x3D;(\mathscr{F}{\text{III}_T}\otimes\mathscr{F}{f})\mathscr{F}{r}$$</p>
<p>$$&#x3D;(\text{III}_\frac{1}{T}\otimes\mathscr{F}{f})\mathscr{F}{r}$$<br>$$&#x3D;[\text{III}_\frac{1}{T}(\omega)\otimes F(\omega)]\mathscr{F}{r}$$</p>
<p>我们知道，$\text{Shah}$函数实际上就是一堆平移了的狄拉克函数之和，因此$\text{III}_\frac{1}{T}(\omega)\otimes F(\omega)$实际可解释为<strong>所有将$F$在频域上平移$\frac{k}{T}(k\in \mathbb{Z})$的函数的和</strong>，反映在频域图像上，就好像我们为函数$F$创建了无穷多的“副本”一样，这就是闫神在课上提到过的含义，也是“采样”过程对于函数频域的影响。</p>
<p>至于这个$T$，我们是可以人为选取的，只要我们的$T$选取的足够小，$\frac{1}{T}$足够大，使得$F$平移之后的图像不发生重叠，就可以保留$F$的信息。更具体的，采样频率大于等于$f$频率的两倍就可以，这就是<strong>奈奎斯特采样定理</strong>。</p>
<p>因此，若要从采样以后的函数$\text{III}_T(x)f(x)$获得原本的函数$f(x)$，实际只需保留$F(\omega)$在原点处的那一份“副本”即可，我们可以通过乘上一个盒子函数$\Pi_T(x)$来做到，$\Pi_T(x)$仅在$|x|&lt;T$时取值$\frac{1}{2T}$，其它情况下取值均为$0$。</p>
<p>因此，我们只要取$\mathscr{F}{r}&#x3D;\Pi_T$就可以还原出$f$，这是容易验证的，而盒子函数的傅里叶反变换是$\text{sinc}$函数，理论上讲这就能完美还原出$f$了。</p>
<p>看起来实在是太好了。遗憾的是，$\text{sinc}$函数本身的频率是无限的，或者说，$\text{sinc}$压根就不是个周期函数，如果真的取$r&#x3D;\text{sinc}$，我们还得对所有采样值进行无穷求和才能还原任意处的$f$。因此，实际操作中使用的滤波函数往往是频率有限的，但是效果怎么样就不好说了。</p>
<p>以图形学反走样时最简单的滤波方法为例，我们常常对一个像素区域内进行超采样，然后直接做平均值，这实际上就是一个二维的盒子函数，对应到频域上，实际是在用$\text{sinc}$乘以$F$，效果自然不甚理想。</p>
<h1 id="text-3-走样"><a href="#text-3-走样" class="headerlink" title="$\text{3.走样}$"></a>$\text{3.走样}$</h1><h2 id="text-3-1-Recap-GAMES101"><a href="#text-3-1-Recap-GAMES101" class="headerlink" title="$\text{3.1.Recap:GAMES101}$"></a>$\text{3.1.Recap:GAMES101}$</h2><p>然而实际上我们要面临的问题不仅仅是$\text{sinc}$是无穷的。$f$本身的频率常常也是无穷的，这样一来，我们不能将$\mathscr{F}{f}$的图像限定在一个有限区间上，用无穷的语言来描述:</p>
<p>$\forall \omega_0&gt;0,\exist \omega \text{ s.t.}|\omega|&gt;\omega_0,\mathscr{F}{f}(\omega)\neq 0$</p>
<p>这时我们不能在一个有穷的区间上考虑$F$的频域图了，而且将$F$平移几乎不可避免地会引起频域信号的混叠，这也意味着有限的采样率几乎上不可避免地会引起信息的丢失。此外，按照前面提过的说法，对于频率有限的信号，若采样率不足够，也会引起频谱的混叠与信息的丢失。这正是闫令琪在$\text{GAMES101}$上讲过的观点。此时如果将频谱截断，就产生了走样。</p>
<p>不幸的是，图形学里的信号频率常常是无穷的。实际上，<strong>任何不连续函数的频率都是无穷的</strong>。因此，除了对采样率本身的修正，我们还要考虑其它的办法来进行反走样。</p>
<h2 id="text-3-2-反走样"><a href="#text-3-2-反走样" class="headerlink" title="$\text{3.2.反走样}$"></a>$\text{3.2.反走样}$</h2><h3 id="text-3-2-1-非一致采样"><a href="#text-3-2-1-非一致采样" class="headerlink" title="$\text{3.2.1.非一致采样}$"></a>$\text{3.2.1.非一致采样}$</h3><p>给一个随机偏差$\xi \in [0,1]$，采样函数是$\sum\limits_{i&#x3D;-\infty}^{+\infty}\delta[x-(i+\frac{1}{2}-\xi)T]$</p>
<p>因为随机所以图像会有噪点，但是走样就没那么明显。</p>
<h3 id="text-3-2-2-适应性采样"><a href="#text-3-2-2-适应性采样" class="headerlink" title="$\text{3.2.2.适应性采样}$"></a>$\text{3.2.2.适应性采样}$</h3><p>在高频信号处多采样，但是实践起来较困难，很难判断一个区域内部信号频率与采样率的关系。对邻接点判断变化速度的办法在实际上没有什么走样的时候往往会差异较大。</p>
<h3 id="text-3-2-3-预过滤"><a href="#text-3-2-3-预过滤" class="headerlink" title="$\text{3.2.3.预过滤}$"></a>$\text{3.2.3.预过滤}$</h3><p>所谓预过滤，其实就是在采样之前先对函数做模糊，砍掉高频信号使得在当前采样率下不会发生走样。当然，这么做损失了信息，图像模糊了，但是相比于走样还是要好些。</p>
<p>我们之前提到过对采样得到的函数$\tilde{f}$的频谱乘上盒子函数来过滤掉高频信息，这实际上也可以对$f$做，如果$f$的频率是无穷大的，在频域上乘上一个盒子函数就砍掉了$f$的高频信息，这相当于对$f$做卷积。</p>
<p>假设采样频率是$\omega_s$，我们只需要算$f\otimes\text{sinc}(2\omega_sx)$就可以了，当然直接用$\text{sinc}$的卷积是不好做的，但是我们可以用其它函数来做这个事情，只要这些函数的频域表示跟最理想的$\text{sinc}$足够接近即可。</p>
<h1 id="text-4-应用至图像合成"><a href="#text-4-应用至图像合成" class="headerlink" title="$\text{4.应用至图像合成}$"></a>$\text{4.应用至图像合成}$</h1><p>实际中我们可以把渲染得到的图像看作是一个二元函数$f(x,y)$，其值为对应点得到的$\text{Radiance}$。</p>
<p>好消息是，光追可以算出任意点的$f(x,y)$，坏消息是，这样基本不可能在采样之前预过滤。这样一来，我们能用的还是非一致采样或者适应性采样。</p>
<h1 id="text-5-渲染中走样的来源"><a href="#text-5-渲染中走样的来源" class="headerlink" title="$\text{5.渲染中走样的来源}$"></a>$\text{5.渲染中走样的来源}$</h1><p>一种是几何走样。物体的边界投影至屏幕时，几乎一定会产生颜色的跃变，使得图像信号不连续。此外，极小的物体（尺度小于采样率）也会。</p>
<p>另一种是着色走样。一方面来自于不正确的纹理过滤或者高光，另一方面来自于阴影。</p>
<p>尽管检测物体表面的边界不是没有办法，但是检测阴影的边界要难得多。</p>
<h1 id="text-6-像素到底是什么"><a href="#text-6-像素到底是什么" class="headerlink" title="$\text{6.像素到底是什么}$"></a>$\text{6.像素到底是什么}$</h1><p>PBR书说，关于像素有两点需要牢记的观点。首先，像素是整个图片在离散的<strong>点</strong>上进行采样后重建的结果，<strong>点是没有面积的</strong>。Alvy Ray Smith指出：<strong>把像素看成有面积的小方块是不正确的心理认知，会导致一系列的错误</strong>。</p>
<p>第二个观点是，像素自然而然都是整数点处的信号值，<strong>但是采样可以在浮点数坐标上进行</strong>。要想把$\mathbb{R}^2$上的颜色映射到$\mathbb{N}^2$上，最简单的方法就是取距离最近的整数点——这和像素的含义已经差不太多了，唯一的遗憾是有一个$\frac{1}{2}$的偏移，这个小细节如果在撸码的时候忘记了，有时候会造成微小的错误，所以在定义这个映射的时候就把$\frac{1}{2}$的偏移加上，就方便多了。</p>
<p>到此，理论基础就结束了，PBR书中接下来会详细介绍它的采样方法。。。有机会再写吧。</p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Rendering/" rel="tag"># Rendering</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/04/12/2DFA=DFA/" rel="prev" title="2DFA和DFA的等价性">
                  <i class="fa fa-chevron-left"></i> 2DFA和DFA的等价性
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/09/13/CSE-272-Hw/" rel="next" title="UCSD CSE272-Advanced Image Synthesis-Homework">
                  UCSD CSE272-Advanced Image Synthesis-Homework <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CLV</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
